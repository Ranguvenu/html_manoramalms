{"version":3,"file":"calendarcards.min.js","sources":["../src/calendarcards.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n/**\r\n *\r\n * @module     block/Notification\r\n * @package    block_notification\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine([\r\n    'core/templates',\r\n    'core/ajax',\r\n    'jquery',\r\n], function (Templates, Ajax, $) {\r\n    var users;\r\n    return users = {\r\n        init: function (args) {\r\n            const calendar = document.getElementById('customcalendar');\r\n            // console.log(calendar);\r\n            // Generate and append date cards\r\n            var time = $('#time').val() * 1000;\r\n            const d = new Date(time);\r\n            var year = $(\"#id_year\").val();\r\n            var month = $(\"#id_month\").val();\r\n            const months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n            var monthname = months[parseInt(month) - 1].substring(0, 3);\r\n            var days = new Date(parseInt(year), parseInt(month), 0).getDate();\r\n            var gsDayNames = [\r\n                'Sunday',\r\n                'Monday',\r\n                'Tuesday',\r\n                'Wednesday',\r\n                'Thursday',\r\n                'Friday',\r\n                'Saturday'\r\n            ];\r\n            for (let i = 1; i <= days; i++) {\r\n                const card = document.createElement('div');\r\n                card.classList.add('card');\r\n                card.textContent = i;\r\n                const newd = new Date(year + '-' + month + '-' + i);\r\n                var day = gsDayNames[newd.getDay()];\r\n                // onclick=\"(function(e){ require(\\'block_notification/calendarcards\\').customCalendar({year:' + year + ',month:' + month + ',day:' + i + ',courseid:1,categoryid:0})})(event)\"\r\n                card.innerHTML = '<div class=\"datesinfo\"><a class=\"dateslink\" href=\"javascript:void(0)\" data-year=' + year + ' data-month= ' + month + ' data-day = ' + i + ' data-courseid=1 data-categoryid=0 ><div class=\"monthinfo\">' + monthname + '</div><div class=\"dateinfo\">' + i + '</div><div class=\"dayinfo\">' + day.substring(0, 3) + '</div></a><div>'\r\n                // console.log(card);\r\n                calendar.appendChild(card);\r\n            }\r\n            $(document).on('click', '.dateslink', function () {\r\n                $('.card').removeClass('active');\r\n                var parentfirst = $(this).parent();\r\n                var parentsecond = $(parentfirst).parent();\r\n                $(parentsecond).addClass('active');\r\n                console.log($(this).data());\r\n                users.customCalendar($(this).data());\r\n            });\r\n        },\r\n        customCalendar: function (params) {\r\n            // #ED396C\r\n            // $('.activehover').css(\"background-color\",'#ED396C');\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_notification_calendar_details',\r\n                args: params\r\n            }]);\r\n            $(\"#customcalendardata\").empty();\r\n            promise[0].done(function (resp) {\r\n                console.log(resp['events']);\r\n                if (resp.events.length == 0) {\r\n                    $('#customcalendardata').html('<div class=\"text-center calendar_events attempt_text\"><h4>No Events Available on this Date.</></h4></div>');\r\n                } else {\r\n                    var data = Templates.render('block_notification/customcalendardata', { events: resp['events'] });\r\n                    data.then(function (html, js) {\r\n                        $('#customcalendardata').html(html);\r\n                    });\r\n                }\r\n\r\n            }).fail(function (ex) {\r\n                // do something with the exception\r\n                console.log(ex);\r\n            });\r\n        },\r\n        load: function () {\r\n            $(document).on('change', '#id_month , #id_year', function () {\r\n                $(\"#customcalendar\").empty();\r\n                new users.init();\r\n                var year = $(\"#id_year\").val();\r\n                var month = $(\"#id_month\").val();\r\n                var day = 1;\r\n                // if (day > 9) {\r\n                // var scrollval = day * 85;\r\n                // $('#customcalendar').animate({\r\n                //     scrollLeft: '+=' + parseInt(scrollval) + 'px'\r\n                // }, \"slow\");\r\n                // }    \r\n                let scrollWidth = $('#customcalendar').get(0).scrollWidth;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '-=' + scrollWidth + 'px'\r\n                }, \"slow\");\r\n                const d = new Date();\r\n                var presentmonth = parseInt(d.getMonth()) + parseInt(1);\r\n                if (presentmonth == month) {\r\n                    day = $(\"input[name=day]\").val();\r\n                    if (day > 9) {\r\n                        var scrollval = day * 85;\r\n                        $('#customcalendar').animate({\r\n                            scrollLeft: '+=' + parseInt(scrollval) + 'px'\r\n                        }, \"slow\");\r\n                    }\r\n                }\r\n                const params = { year: year, month: month, day: day, courseid: 1, categoryid: 0 };\r\n                new users.customCalendar(params);\r\n                users.active(day);\r\n            });\r\n            var year = $(\"#id_year\").val();\r\n            var month = $(\"#id_month\").val();\r\n            var day = $(\"input[name=day]\").val();\r\n            if (day > 9) {\r\n                var scrollval = day * 85;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '+=' + parseInt(scrollval) + 'px'\r\n                }, \"slow\");\r\n            }\r\n            users.active(parseInt(day));\r\n\r\n            const params = { year: parseInt(year), month: parseInt(month), day: parseInt(day), courseid: 1, categoryid: 0 };\r\n            new users.customCalendar(params);\r\n            $('.horizon-prev').click(function (e) {\r\n                e.preventDefault();\r\n                let currentScroll = $('#customcalendar').get(0).scrollLeft;\r\n                let scrollWidth = $('#customcalendar').get(0).scrollWidth;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '-=300px'\r\n                }, \"slow\");\r\n            });\r\n            $('.horizon-next').click(function (e) {\r\n                e.preventDefault();\r\n                let currentScroll = $('#customcalendar').get(0).scrollLeft;\r\n                let scrollWidth = $('#customcalendar').get(0).scrollWidth;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '+=300px'\r\n                }, \"slow\");\r\n            });\r\n        },\r\n        active: function (day) {\r\n            $(\".dateinfo\").each(function () {\r\n                var dateval = $(this).text();\r\n                if (dateval == day) {\r\n                    var parent = $(this).parent();\r\n                    var parent1 = parent.parent();\r\n                    var id = parent1.parent();\r\n                    $(id).addClass('active');\r\n                }\r\n            });\r\n        }\r\n    };\r\n});\r\n"],"names":["define","Templates","Ajax","$","users","init","args","calendar","document","getElementById","time","val","Date","year","month","monthname","parseInt","substring","days","getDate","gsDayNames","i","card","createElement","classList","add","textContent","day","getDay","innerHTML","appendChild","on","removeClass","parentfirst","this","parent","parentsecond","addClass","console","log","data","customCalendar","params","promise","call","methodname","empty","done","resp","events","length","html","render","then","js","fail","ex","load","scrollWidth","get","animate","scrollLeft","d","getMonth","scrollval","courseid","categoryid","active","click","e","preventDefault","each","text","id"],"mappings":"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"}